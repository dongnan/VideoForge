# VideoForge æµ‹è¯•ç”¨ä¾‹

è¿™ä¸ªç›®å½•åŒ…å«äº† VideoForge çš„å„ç§æµ‹è¯•è„šæœ¬å’Œæµ‹è¯•ç”¨ä¾‹ã€‚

## ğŸ“‹ æµ‹è¯•æ–‡ä»¶è¯´æ˜

### Python æµ‹è¯•

#### 1. `test_resolution_detection.py`
**æµ‹è¯•åˆ†è¾¨ç‡æ£€æµ‹é€»è¾‘ï¼ˆåŒ…æ‹¬2K/4Kå’Œæ¨ªç«–å±è¯†åˆ«ï¼‰**

**åŠŸèƒ½**:
- æµ‹è¯•åˆ†è¾¨ç‡ç­‰çº§è¯†åˆ«ï¼ˆSD/720p/1080p/2K/4Kï¼‰
- æµ‹è¯•æ¨ªå±å’Œç«–å±è§†é¢‘çš„æ­£ç¡®è¯†åˆ«
- æ˜¾ç¤ºå„åˆ†è¾¨ç‡çš„ç ç‡ä¼°ç®—è¡¨

**è¿è¡Œæ–¹æ³•**:
```bash
cd /Volumes/Disk0/CodeBuddy/VideoForge
python3 tests/test_resolution_detection.py
```

**æµ‹è¯•è¦†ç›–**:
- âœ… æ¨ªå± 1080p (1920x1080) â†’ 1080p
- âœ… ç«–å± 1080p (1080x1920) â†’ 1080p
- âœ… æ¨ªå± 2K (2560x1440) â†’ 2K
- âœ… ç«–å± 2K (1440x2560) â†’ 2K
- âœ… æ¨ªå± 4K (3840x2160) â†’ 4K
- âœ… ç«–å± 4K (2160x3840) â†’ 4K
- âœ… SD è§†é¢‘ (640x480) â†’ SD

**é¢„æœŸè¾“å‡º**:
```
ğŸ§ª æµ‹è¯•åˆ†è¾¨ç‡ç­‰çº§è¯†åˆ«
============================================================
âœ… 1920x1080 (æ¨ªå±) â†’ 1080p (çŸ­è¾¹:1080)
âœ… 1080x1920 (ç«–å±) â†’ 1080p (çŸ­è¾¹:1080)
...
âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼

ğŸ“Š ç ç‡ä¼°ç®—è¡¨
====================================================================================================
### H264 ç¼–ç  ###
åˆ†è¾¨ç‡        | CRF 20               | CRF 23               | CRF 28
----------------------------------------------------------------------------------------------------
4K         | 20.0 Mbps            | 12.0 Mbps            | 6.0 Mbps
...
```

---

#### 2. `test_estimation.py`
**æµ‹è¯•æ™ºèƒ½é¢„ä¼°åŠŸèƒ½**

**åŠŸèƒ½**:
- æµ‹è¯•è½¬ç å‰æ–‡ä»¶å¤§å°é¢„ä¼°ç®—æ³•
- éªŒè¯æ™ºèƒ½è·³è¿‡é€»è¾‘

**è¿è¡Œæ–¹æ³•**:
```bash
cd /Volumes/Disk0/CodeBuddy/VideoForge
python3 tests/test_estimation.py
```

**æµ‹è¯•å†…å®¹**:
- åŸºäºç ç‡å’Œæ—¶é•¿çš„æ–‡ä»¶å¤§å°é¢„ä¼°
- åˆ¤æ–­æ˜¯å¦åº”è¯¥è·³è¿‡è½¬ç 
- å¯¹æ¯”é¢„ä¼°å€¼ä¸å®é™…å€¼çš„å‡†ç¡®æ€§

---

### Shell æµ‹è¯•

#### 3. `test_setup.sh`
**æµ‹è¯•ç¯å¢ƒè®¾ç½®è„šæœ¬**

**åŠŸèƒ½**:
- æ£€æŸ¥ FFmpeg æ˜¯å¦æ­£ç¡®å®‰è£…
- éªŒè¯ Python ç‰ˆæœ¬
- æµ‹è¯•åŸºæœ¬çš„è§†é¢‘å¤„ç†åŠŸèƒ½

**è¿è¡Œæ–¹æ³•**:
```bash
bash tests/test_setup.sh
```

**æ£€æŸ¥é¡¹**:
- âœ… FFmpeg å®‰è£…æ£€æŸ¥
- âœ… Python 3 ç‰ˆæœ¬æ£€æŸ¥
- âœ… ä¾èµ–åº“æ£€æŸ¥
- âœ… VideoForge åŸºæœ¬åŠŸèƒ½æµ‹è¯•

---

#### 4. `test_smart_skip.sh`
**æµ‹è¯•æ™ºèƒ½è·³è¿‡åŠŸèƒ½**

**åŠŸèƒ½**:
- æµ‹è¯•æ™ºèƒ½è·³è¿‡é€»è¾‘æ˜¯å¦æ­£å¸¸å·¥ä½œ
- éªŒè¯é¢„ä¼°ç®—æ³•çš„å‡†ç¡®æ€§

**è¿è¡Œæ–¹æ³•**:
```bash
bash tests/test_smart_skip.sh
```

**æµ‹è¯•åœºæ™¯**:
- ä½ç ç‡è§†é¢‘åº”è¯¥è¢«è·³è¿‡
- é«˜ç ç‡è§†é¢‘åº”è¯¥è¢«è½¬ç 
- é¢„ä¼°å‡†ç¡®æ€§éªŒè¯

---

## ğŸ§ª è¿è¡Œæ‰€æœ‰æµ‹è¯•

### å¿«é€Ÿæµ‹è¯•
```bash
# è¿è¡Œæ‰€æœ‰ Python æµ‹è¯•
cd /Volumes/Disk0/CodeBuddy/VideoForge
python3 tests/test_resolution_detection.py
python3 tests/test_estimation.py
```

### å®Œæ•´æµ‹è¯•
```bash
# åŒ…æ‹¬ç¯å¢ƒæ£€æŸ¥å’ŒåŠŸèƒ½æµ‹è¯•
cd /Volumes/Disk0/CodeBuddy/VideoForge
bash tests/test_setup.sh
bash tests/test_smart_skip.sh
python3 tests/test_resolution_detection.py
python3 tests/test_estimation.py
```

---

## ğŸ“Š æµ‹è¯•çŸ©é˜µ

### åˆ†è¾¨ç‡æµ‹è¯•

| åˆ†è¾¨ç‡ | æ¨ªå± | ç«–å± | çŠ¶æ€ |
|--------|------|------|------|
| 4K (2160p) | âœ… | âœ… | é€šè¿‡ |
| 2K (1440p) | âœ… | âœ… | é€šè¿‡ |
| 1080p | âœ… | âœ… | é€šè¿‡ |
| 720p | âœ… | âœ… | é€šè¿‡ |
| SD (<720p) | âœ… | âœ… | é€šè¿‡ |

### ç¼–ç æµ‹è¯•

| ç¼–ç  | CRF 20 | CRF 23 | CRF 28 | çŠ¶æ€ |
|------|--------|--------|--------|------|
| H.264 | âœ… | âœ… | âœ… | é€šè¿‡ |
| H.265 | âœ… | âœ… | âœ… | é€šè¿‡ |

### æ™ºèƒ½è·³è¿‡æµ‹è¯•

| åœºæ™¯ | é¢„æœŸè¡Œä¸º | çŠ¶æ€ |
|------|----------|------|
| å·²æ˜¯ç›®æ ‡ç¼–ç ä¸”ç ç‡ä½ | è·³è¿‡ | âœ… |
| é¢„ä¼°è½¬ç åä¼šå˜å¤§ | è·³è¿‡ | âœ… |
| éœ€è¦è½¬ç  | æ‰§è¡Œ | âœ… |
| åˆ†è¾¨ç‡éœ€è¦è°ƒæ•´ | æ‰§è¡Œ | âœ… |

---

## ğŸ”§ ç¼–å†™æ–°æµ‹è¯•

### Python æµ‹è¯•æ¨¡æ¿

```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
æµ‹è¯• XXX åŠŸèƒ½
"""

from videoforge import VideoForge

def test_feature():
    """æµ‹è¯•æŸä¸ªåŠŸèƒ½"""
    forge = VideoForge()
    
    # æµ‹è¯•é€»è¾‘
    result = forge.some_method()
    
    # æ–­è¨€
    assert result == expected, f"æœŸæœ› {expected}, å®é™… {result}"
    
    print("âœ… æµ‹è¯•é€šè¿‡")

if __name__ == '__main__':
    test_feature()
```

### Shell æµ‹è¯•æ¨¡æ¿

```bash
#!/bin/bash
# æµ‹è¯• XXX åŠŸèƒ½

echo "ğŸ§ª æµ‹è¯• XXX åŠŸèƒ½"
echo "======================================"

# æµ‹è¯•æ­¥éª¤
if some_command; then
    echo "âœ… æµ‹è¯•é€šè¿‡"
else
    echo "âŒ æµ‹è¯•å¤±è´¥"
    exit 1
fi
```

---

## ğŸ“ æµ‹è¯•æœ€ä½³å®è·µ

1. **å•ä¸€èŒè´£**: æ¯ä¸ªæµ‹è¯•åªæµ‹è¯•ä¸€ä¸ªåŠŸèƒ½ç‚¹
2. **ç‹¬ç«‹æ€§**: æµ‹è¯•ä¹‹é—´ä¸åº”è¯¥ç›¸äº’ä¾èµ–
3. **å¯é‡å¤**: æµ‹è¯•ç»“æœåº”è¯¥æ˜¯ç¡®å®šæ€§çš„
4. **æ¸…æ™°è¾“å‡º**: ä½¿ç”¨è¡¨æƒ…ç¬¦å·å’Œé¢œè‰²æ ‡è¯†æµ‹è¯•ç»“æœ

### æµ‹è¯•è¾“å‡ºè§„èŒƒ

- âœ… è¡¨ç¤ºæµ‹è¯•é€šè¿‡
- âŒ è¡¨ç¤ºæµ‹è¯•å¤±è´¥
- âš ï¸ è¡¨ç¤ºè­¦å‘Š
- â„¹ï¸ è¡¨ç¤ºä¿¡æ¯
- ğŸ§ª è¡¨ç¤ºæµ‹è¯•å¼€å§‹

---

## ğŸ› è°ƒè¯•æµ‹è¯•

### è¯¦ç»†è¾“å‡º
```bash
# Python æµ‹è¯•
python3 -v tests/test_resolution_detection.py

# Shell æµ‹è¯•
bash -x tests/test_smart_skip.sh
```

### å•ç‹¬æµ‹è¯•æŸä¸ªåŠŸèƒ½
```python
# åœ¨æµ‹è¯•æ–‡ä»¶ä¸­
if __name__ == '__main__':
    # åªè¿è¡Œè¿™ä¸€ä¸ªæµ‹è¯•
    test_specific_feature()
```

---

## ğŸ“ˆ æµ‹è¯•è¦†ç›–ç‡

å½“å‰æµ‹è¯•è¦†ç›–çš„ä¸»è¦åŠŸèƒ½ï¼š

- âœ… åˆ†è¾¨ç‡æ£€æµ‹ï¼ˆåŒ…æ‹¬æ¨ªç«–å±ï¼‰
- âœ… ç ç‡ä¼°ç®—
- âœ… æ™ºèƒ½è·³è¿‡é€»è¾‘
- âœ… æ–‡ä»¶å¤§å°é¢„ä¼°
- âœ… è§†é¢‘ä¿¡æ¯è·å–
- â³ æ‰¹é‡å¤„ç†ï¼ˆå¾…æ·»åŠ ï¼‰
- â³ é”™è¯¯å¤„ç†ï¼ˆå¾…æ·»åŠ ï¼‰
- â³ è¾¹ç•Œæƒ…å†µï¼ˆå¾…æ·»åŠ ï¼‰

---

## ğŸ”„ æŒç»­é›†æˆ

### GitHub Actions é…ç½®ç¤ºä¾‹

```yaml
name: Tests

on: [push, pull_request]

jobs:
  test:
    runs-on: macos-latest
    steps:
      - uses: actions/checkout@v2
      - name: Install FFmpeg
        run: brew install ffmpeg
      - name: Run tests
        run: |
          python3 tests/test_resolution_detection.py
          python3 tests/test_estimation.py
          bash tests/test_setup.sh
```

---

**æ›´æ–°æ—¶é—´**: 2025-11-09  
**VideoForge ç‰ˆæœ¬**: v2.2.0
