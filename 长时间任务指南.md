# VideoForge é•¿æ—¶é—´ä»»åŠ¡è¿è¡ŒæŒ‡å—

## ðŸ“Š å½“å‰ä»»åŠ¡çŠ¶æ€

### ä»»åŠ¡ä¿¡æ¯
- **å¯åŠ¨æ—¶é—´**: 2025-11-09 19:07:18
- **æºç›®å½•**: `/Volumes/Disk0/DongNan/Nextcloud/è§†é¢‘/`
- **ç›®æ ‡ç›®å½•**: `/Volumes/Disk0/Processing`
- **æ€»æ–‡ä»¶æ•°**: 4,547 ä¸ªè§†é¢‘
- **ç¼–ç æ ¼å¼**: H.264 (QuickTime å…¼å®¹)
- **è´¨é‡**: medium (CRF 23)

### å½“å‰è¿›åº¦ï¼ˆ2025-11-09 20:33ï¼‰
- **è¿è¡Œæ—¶é•¿**: 26 å°æ—¶ 15 åˆ†é’Ÿ
- **å½“å‰å¤„ç†**: ç¬¬ 6 ä¸ªæ–‡ä»¶
- **æ­£åœ¨å¤„ç†**: `è¡Œè½¦è®°å½•_2024-04-04.mp4` (29GB è¶…å¤§æ–‡ä»¶)
  - åŽŸå§‹å¤§å°: 29GB
  - å·²è¾“å‡º: 3.4GB (çº¦ 11.7%)
  - é¢„è®¡å‰©ä½™æ—¶é—´: ~8-9 å¤©

### ç³»ç»Ÿèµ„æº
- **ç£ç›˜ç©ºé—´**: 5.3TB å¯ç”¨ (è¶³å¤Ÿ)
- **CPU ä½¿ç”¨**: 565% (å¤šæ ¸å¹¶è¡Œ)
- **å†…å­˜ä½¿ç”¨**: 3.4%

---

## ðŸ” ç›‘æŽ§æ–¹æ³•

### 1. å¿«é€ŸæŸ¥çœ‹çŠ¶æ€
```bash
# ä½¿ç”¨ä¸“ç”¨é•¿æ—¶é—´ä»»åŠ¡ç›‘æŽ§è„šæœ¬
bash /Volumes/Disk0/CodeBuddy/VideoForge/monitor_long_task.sh
```

**æ˜¾ç¤ºä¿¡æ¯**:
- âœ… è¿›ç¨‹è¿è¡ŒçŠ¶æ€
- ðŸ“ˆ å¤„ç†è¿›åº¦ç»Ÿè®¡
- ðŸ’¾ è¾“å‡ºç›®å½•å¤§å°
- ðŸ’¿ ç£ç›˜å‰©ä½™ç©ºé—´
- ðŸ“ æœ€æ–°å¤„ç†æ—¥å¿—

### 2. å®žæ—¶ç›‘æŽ§ï¼ˆæŽ¨èï¼‰
```bash
# æ¯ 10 ç§’è‡ªåŠ¨åˆ·æ–°
watch -n 10 'bash /Volumes/Disk0/CodeBuddy/VideoForge/monitor_long_task.sh'
```

### 3. æŸ¥çœ‹å®žæ—¶æ—¥å¿—
```bash
# æŸ¥çœ‹å®Œæ•´æ—¥å¿—æµ
tail -f /Volumes/Disk0/CodeBuddy/VideoForge/logs/videoforge_20251109.log
```

### 4. æ£€æŸ¥å½“å‰æ–‡ä»¶è¿›åº¦
```bash
# æŸ¥çœ‹æ­£åœ¨å¤„ç†çš„æ–‡ä»¶å¤§å°å˜åŒ–
watch -n 30 'ls -lh /Volumes/Disk0/Processing/è¡Œè½¦è§†é¢‘/è¡Œè½¦è®°å½•_2024-04-04.mp4'
```

### 5. æ£€æŸ¥è¿›ç¨‹æ˜¯å¦å­˜æ´»
```bash
# æŸ¥çœ‹è¿›ç¨‹çŠ¶æ€
ps -p 47950,47959 -o pid,pcpu,pmem,etime,command
```

---

## âš™ï¸ ä»»åŠ¡ç®¡ç†

### æš‚åœä»»åŠ¡ï¼ˆä¸æŽ¨èï¼‰
```bash
# æš‚åœ Python è¿›ç¨‹
kill -STOP 47950

# æ¢å¤è¿›ç¨‹
kill -CONT 47950
```

**æ³¨æ„**: æš‚åœ FFmpeg è¿›ç¨‹å¯èƒ½å¯¼è‡´è¾“å‡ºæ–‡ä»¶æŸåï¼Œä¸å»ºè®®æš‚åœã€‚

### åœæ­¢ä»»åŠ¡
```bash
# ä¼˜é›…åœæ­¢ï¼ˆæŽ¨èï¼‰
kill 47950

# å¼ºåˆ¶åœæ­¢ï¼ˆä»…åœ¨å¿…è¦æ—¶ï¼‰
kill -9 47950
kill -9 47959
```

### é‡å¯ä»»åŠ¡
å¦‚æžœä»»åŠ¡æ„å¤–ä¸­æ–­ï¼Œä½¿ç”¨ç›¸åŒå‘½ä»¤é‡æ–°å¯åŠ¨ï¼š

```bash
cd /Volumes/Disk0/CodeBuddy/VideoForge

python3 videoforge.py transcode \
    "/Volumes/Disk0/DongNan/Nextcloud/è§†é¢‘/" \
    -o /Volumes/Disk0/Processing \
    --codec h264 \
    --quality medium \
    --resolution original \
    --smart-skip \
    --skip-existing  # é‡è¦ï¼šè·³è¿‡å·²å¤„ç†çš„æ–‡ä»¶
```

---

## ðŸ“ˆ é¢„æœŸå¤„ç†æ—¶é—´

### å½“å‰æ–‡ä»¶ï¼ˆè¡Œè½¦è®°å½•_2024-04-04.mp4ï¼‰
- **åŽŸå§‹å¤§å°**: 29GB
- **å½“å‰è¿›åº¦**: 3.4GB / 29GB (11.7%)
- **å·²ç”¨æ—¶é—´**: 26 å°æ—¶
- **é¢„è®¡æ€»æ—¶é—´**: ~222 å°æ—¶ (9.25 å¤©)
- **é¢„è®¡å®Œæˆ**: 2025-11-18 å·¦å³

### æ€»ä»»åŠ¡é¢„ä¼°
åŸºäºŽæ™ºèƒ½è·³è¿‡çš„æ•ˆæžœï¼š
- **æ™ºèƒ½è·³è¿‡**: é¢„è®¡ 4,500+ ä¸ªæ–‡ä»¶ï¼ˆå·²æ˜¯ä½Žç çŽ‡ï¼‰
- **éœ€è¦è½¬ç **: é¢„è®¡ 40-50 ä¸ªæ–‡ä»¶
- **æ€»é¢„è®¡æ—¶é—´**: 10-15 å¤©ï¼ˆå–å†³äºŽæ–‡ä»¶å¤§å°åˆ†å¸ƒï¼‰

---

## ðŸ›¡ï¸ æ•…éšœå¤„ç†

### é—®é¢˜ 1: è¿›ç¨‹æ„å¤–åœæ­¢
**æ£€æŸ¥**:
```bash
ps aux | grep videoforge
```

**è§£å†³**:
```bash
# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
tail -50 /Volumes/Disk0/CodeBuddy/VideoForge/logs/errors.log

# é‡æ–°å¯åŠ¨ï¼ˆå¸¦ --skip-existingï¼‰
bash examples/process_nextcloud_videos_h264.sh
```

### é—®é¢˜ 2: ç£ç›˜ç©ºé—´ä¸è¶³
**æ£€æŸ¥**:
```bash
df -h /Volumes/Disk0
```

**è§£å†³**:
- æ¸…ç† `/Volumes/Disk0/Processing` ä¸­å·²å®Œæˆä¸”éªŒè¯è¿‡çš„æ–‡ä»¶
- æˆ–æ‰©å±•ç£ç›˜ç©ºé—´

### é—®é¢˜ 3: CPU è¿‡çƒ­æˆ–ç³»ç»Ÿå¡é¡¿
**ä¸´æ—¶é™ä½Žä¼˜å…ˆçº§**:
```bash
# é™ä½Žè¿›ç¨‹ä¼˜å…ˆçº§ï¼ˆnice å€¼è¶Šå¤§ä¼˜å…ˆçº§è¶Šä½Žï¼‰
renice -n 10 -p 47950
renice -n 10 -p 47959
```

### é—®é¢˜ 4: è½¬ç åŽæ–‡ä»¶æŸå
**éªŒè¯æ–‡ä»¶**:
```bash
# ä½¿ç”¨ ffprobe æ£€æŸ¥æ–‡ä»¶å®Œæ•´æ€§
ffprobe /Volumes/Disk0/Processing/è¡Œè½¦è§†é¢‘/è¡Œè½¦è®°å½•_2024-04-04.mp4
```

**ä¿®å¤**:
- åˆ é™¤æŸåçš„è¾“å‡ºæ–‡ä»¶
- é‡æ–°è¿è¡Œè½¬ç ï¼ˆè‡ªåŠ¨ä¼šé‡æ–°å¤„ç†ï¼‰

---

## ðŸ“Š ç›‘æŽ§ä»ªè¡¨æ¿ï¼ˆæ‰‹åŠ¨æŸ¥çœ‹ï¼‰

### æ¯æ—¥æ£€æŸ¥æ¸…å•

#### ä¸Šåˆæ£€æŸ¥ï¼ˆå»ºè®® 10:00ï¼‰
```bash
# 1. æŸ¥çœ‹ä»»åŠ¡çŠ¶æ€
bash /Volumes/Disk0/CodeBuddy/VideoForge/monitor_long_task.sh

# 2. æ£€æŸ¥ç£ç›˜ç©ºé—´
df -h /Volumes/Disk0

# 3. æŸ¥çœ‹é”™è¯¯æ—¥å¿—
tail -20 /Volumes/Disk0/CodeBuddy/VideoForge/logs/errors.log
```

#### æ™šä¸Šæ£€æŸ¥ï¼ˆå»ºè®® 22:00ï¼‰
```bash
# 1. æŸ¥çœ‹å½“å¤©è¿›åº¦
grep "è½¬ç å®Œæˆ" /Volumes/Disk0/CodeBuddy/VideoForge/logs/videoforge_$(date +%Y%m%d).log | wc -l

# 2. æŸ¥çœ‹ç³»ç»Ÿèµ„æº
top -l 1 | head -10

# 3. è®°å½•å½“å‰è¿›åº¦
bash /Volumes/Disk0/CodeBuddy/VideoForge/monitor_long_task.sh >> daily_progress.log
```

---

## ðŸ’¡ ä¼˜åŒ–å»ºè®®

### 1. åŽå°è¿è¡Œï¼ˆå·²å®Œæˆï¼‰
ä»»åŠ¡å·²åœ¨åŽå°ç¨³å®šè¿è¡Œï¼Œæ— éœ€é¢å¤–æ“ä½œã€‚

### 2. å®šæœŸæ£€æŸ¥ï¼ˆå»ºè®®ï¼‰
åˆ›å»ºå®šæ—¶ä»»åŠ¡è‡ªåŠ¨è®°å½•è¿›åº¦ï¼š

```bash
# ç¼–è¾‘ crontab
crontab -e

# æ·»åŠ ä»¥ä¸‹è¡Œï¼ˆæ¯å°æ—¶è®°å½•ä¸€æ¬¡ï¼‰
0 * * * * bash /Volumes/Disk0/CodeBuddy/VideoForge/monitor_long_task.sh >> /Volumes/Disk0/CodeBuddy/VideoForge/logs/hourly_status.log 2>&1
```

### 3. ç£ç›˜ç©ºé—´é¢„è­¦
```bash
# æ£€æŸ¥è„šæœ¬
cat > /Volumes/Disk0/CodeBuddy/VideoForge/check_disk_space.sh << 'EOF'
#!/bin/bash
THRESHOLD=80  # ä½¿ç”¨çŽ‡è¶…è¿‡ 80% æ—¶è­¦å‘Š
USAGE=$(df -h /Volumes/Disk0 | tail -1 | awk '{print $5}' | sed 's/%//')

if [ "$USAGE" -gt "$THRESHOLD" ]; then
    echo "âš ï¸  è­¦å‘Šï¼šç£ç›˜ä½¿ç”¨çŽ‡ ${USAGE}%ï¼Œè¶…è¿‡é˜ˆå€¼ ${THRESHOLD}%"
    exit 1
else
    echo "âœ… ç£ç›˜ç©ºé—´å……è¶³ï¼šä½¿ç”¨çŽ‡ ${USAGE}%"
    exit 0
fi
EOF

chmod +x /Volumes/Disk0/CodeBuddy/VideoForge/check_disk_space.sh
```

---

## ðŸ“ è¿›åº¦è®°å½•

### 2025-11-09 20:33
- âœ… ä»»åŠ¡æ­£å¸¸è¿è¡Œä¸­
- ðŸ“¹ æ­£åœ¨å¤„ç†: `è¡Œè½¦è®°å½•_2024-04-04.mp4` (29GB)
- ðŸ“Š è¿›åº¦: ç¬¬ 6/4547 ä¸ªæ–‡ä»¶
- ðŸ’¾ å·²è¾“å‡º: 3.4GB
- ðŸ• è¿è¡Œæ—¶é•¿: 26 å°æ—¶ 15 åˆ†
- ðŸ’¿ ç£ç›˜å‰©ä½™: 5.3TB

### 2025-11-10ï¼ˆå¾…æ›´æ–°ï¼‰
_æ¯æ—¥åœ¨æ­¤è®°å½•è¿›åº¦_

---

## ðŸŽ¯ é¢„æœŸç»“æžœ

### æˆåŠŸå®ŒæˆåŽ
1. **è¾“å‡ºç›®å½•**: `/Volumes/Disk0/Processing`
2. **æ–‡ä»¶ç»“æž„**: ä¿æŒä¸Žæºç›®å½•ç›¸åŒçš„ç›®å½•ç»“æž„
3. **æ–‡ä»¶æ ¼å¼**: æ‰€æœ‰è§†é¢‘è½¬æ¢ä¸º H.264/MP4
4. **é¢„æœŸèŠ‚çœç©ºé—´**: 20-40%ï¼ˆå–å†³äºŽåŽŸå§‹ç¼–ç ï¼‰

### è´¨é‡ä¿è¯
- æ‰€æœ‰è½¬ç ä½¿ç”¨ CRF 23ï¼ˆä¸­ç­‰è´¨é‡ï¼‰
- ä¿æŒåŽŸåˆ†è¾¨çŽ‡
- QuickTime å®Œå…¨å…¼å®¹
- æ™ºèƒ½è·³è¿‡å·²ä¼˜åŒ–çš„è§†é¢‘

---

## ðŸ”— ç›¸å…³èµ„æº

- **ä¸»ç¨‹åº**: `/Volumes/Disk0/CodeBuddy/VideoForge/videoforge.py`
- **æ—¥å¿—ç›®å½•**: `/Volumes/Disk0/CodeBuddy/VideoForge/logs/`
- **è¾“å‡ºç›®å½•**: `/Volumes/Disk0/Processing/`
- **ç›‘æŽ§è„šæœ¬**: `/Volumes/Disk0/CodeBuddy/VideoForge/monitor_long_task.sh`

---

## ðŸ“ž å¸¸è§é—®é¢˜

### Q1: ä»»åŠ¡å¯ä»¥ä¸­æ–­å—ï¼Ÿ
A: å¯ä»¥ã€‚ä½¿ç”¨ `--skip-existing` å‚æ•°é‡æ–°è¿è¡Œä¼šè·³è¿‡å·²å¤„ç†çš„æ–‡ä»¶ã€‚

### Q2: å¦‚ä½•åŠ å¿«å¤„ç†é€Ÿåº¦ï¼Ÿ
A: å¯ä»¥ä¿®æ”¹ `--preset` å‚æ•°ï¼ˆfast/ultrafastï¼‰ï¼Œä½†ä¼šç‰ºç‰²åŽ‹ç¼©çŽ‡ã€‚

### Q3: è½¬ç åŽæ–‡ä»¶ä¼šæ›´å¤§å—ï¼Ÿ
A: æ™ºèƒ½è·³è¿‡åŠŸèƒ½ä¼šé¢„ä¼°ï¼Œå¦‚æžœè½¬ç åŽä¼šå˜å¤§åˆ™è‡ªåŠ¨è·³è¿‡ã€‚

### Q4: ç”µè„‘é‡å¯æ€Žä¹ˆåŠžï¼Ÿ
A: é‡æ–°è¿è¡Œç›¸åŒå‘½ä»¤ï¼ŒåŠ ä¸Š `--skip-existing` å³å¯ç»§ç»­ã€‚

### Q5: å¦‚ä½•éªŒè¯è¾“å‡ºæ–‡ä»¶è´¨é‡ï¼Ÿ
A: ä½¿ç”¨ QuickTime æˆ– VLC æ’­æ”¾å™¨éšæœºæŠ½æŸ¥å‡ ä¸ªæ–‡ä»¶ã€‚

---

**åˆ›å»ºæ—¶é—´**: 2025-11-09  
**ä»»åŠ¡é¢„è®¡å®Œæˆ**: 2025-11-20  
**ç»´æŠ¤è€…**: VideoForge Team
